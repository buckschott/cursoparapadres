(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2975],{1142:(e,t,a)=>{"use strict";a.d(t,{U:()=>l});var r=a(9338);function l(){return(0,r.createBrowserClient)("https://qclacxcgfprkswuiboop.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InFjbGFjeGNnZnBya3N3dWlib29wIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjMxMTAwMDYsImV4cCI6MjA3ODY4NjAwNn0.FciBBWAgCDLB_BFEypmH5jbjsjPUkH3ij00u7PbG9gg")}},6242:(e,t,a)=>{Promise.resolve().then(a.bind(a,6692))},6692:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>c});var r=a(5155),l=a(2115),s=a(1142);let n=["Alabama","Alaska","Arizona","Arkansas","California","Colorado","Connecticut","Delaware","Florida","Georgia","Hawaii","Idaho","Illinois","Indiana","Iowa","Kansas","Kentucky","Louisiana","Maine","Maryland","Massachusetts","Michigan","Minnesota","Mississippi","Missouri","Montana","Nebraska","Nevada","New Hampshire","New Jersey","New Mexico","New York","North Carolina","North Dakota","Ohio","Oklahoma","Oregon","Pennsylvania","Rhode Island","South Carolina","South Dakota","Tennessee","Texas","Utah","Vermont","Virginia","Washington","West Virginia","Wisconsin","Wyoming","District of Columbia","Puerto Rico","U.S. Virgin Islands","Guam"];function i(e,t){let a=[];for(let e=0;e<=t.length;e++)a[e]=[e];for(let t=0;t<=e.length;t++)a[0][t]=t;for(let r=1;r<=t.length;r++)for(let l=1;l<=e.length;l++)a[r][l]=t[r-1]===e[l-1]?a[r-1][l-1]:Math.min(a[r-1][l-1]+1,a[r][l-1]+1,a[r-1][l]+1);return a[t.length][e.length]}function o(e,t){let a=e.toLowerCase(),r=t.toLowerCase();if(a===r)return{match:!0,score:100};if(r.startsWith(a))return{match:!0,score:80};if(r.includes(a))return{match:!0,score:50};let l=a.length<=4?1:2,s=i(a,r.substring(0,a.length+l));if(s<=l)return{match:!0,score:60-15*s};let n=r.substring(0,Math.min(a.length+2,r.length)),o=i(a,n);return o<=l?{match:!0,score:55-15*o}:{match:!1,score:0}}function c(){let[e,t]=(0,l.useState)(!1),[a,i]=(0,l.useState)({legal_name:"",case_number:"",court_state:"",court_county:"",attorney_name:"",attorney_email:""}),[c,d]=(0,l.useState)([]),[m,u]=(0,l.useState)(null),[g,b]=(0,l.useState)(null),[x,h]=(0,l.useState)(!1),f=(0,s.U)();(0,l.useEffect)(()=>{(async()=>{let{data:{user:e}}=await f.auth.getUser();e||(window.location.href="/iniciar-sesion")})()},[]),(0,l.useEffect)(()=>{let e=setTimeout(async()=>{let e=a.attorney_name.trim(),t=a.attorney_email.trim().toLowerCase();if(!e&&!t){d([]),u(null),b(null);return}h(!0);try{if(t&&t.length>=5){let{data:e}=await f.from("attorneys").select("id, first_name, last_name, firm_name, email").ilike("email",`${t}%`).limit(20);if(e&&e.length>0){let a=e.filter(e=>e.email?.toLowerCase()===t);if(a.length>1){d(a),u(null),b(t),h(!1);return}if(1===a.length){d([a[0]]),u(a[0]),b(a[0].email),h(!1);return}if(1===e.length&&t.length>=8){d([e[0]]),u(e[0]),b(e[0].email),h(!1);return}}}if(e&&e.length>=3){let t=e.toLowerCase().split(" ").filter(e=>e.length>1);if(0===t.length){d([]),u(null),b(null),h(!1);return}let a=t[t.length-1],r=t[0],l=a.substring(0,Math.max(2,a.length-2)),{data:s}=await f.from("attorneys").select("id, first_name, last_name, firm_name, email").ilike("last_name",`%${l}%`).limit(50);if(s&&s.length>0){let e=s.map(e=>{let l=0,s=(e.first_name||"").toLowerCase(),n=(e.last_name||"").toLowerCase(),i=o(a,n);if(!i.match)return{...e,score:0};if(l+=i.score,t.length>1){let e=o(r,s);e.match?l+=e.score:l-=40}return{...e,score:l}}).filter(e=>e.score>30).sort((e,t)=>t.score-e.score);if(e.length>0&&e[0].score>=50){d([e[0]]),u(e[0]),b(e[0].email),h(!1);return}}if(1===t.length&&r.length>=4){let{data:e}=await f.from("attorneys").select("id, first_name, last_name, firm_name, email").ilike("first_name",`${r}%`).limit(5);if(e&&1===e.length){d([e[0]]),u(e[0]),b(e[0].email),h(!1);return}}}d([]),u(null),b(null)}catch(e){console.error("Attorney search error:",e)}h(!1)},400);return()=>clearTimeout(e)},[a.attorney_name,a.attorney_email]);let p=e=>e.first_name||e.last_name?[e.first_name,e.last_name].filter(Boolean).join(" "):e.firm_name||"Unknown",y=async e=>{e.preventDefault(),t(!0);let{data:{user:r}}=await f.auth.getUser();if(!r){window.location.href="/iniciar-sesion";return}let l=g||a.attorney_email,s={...a,attorney_email:l,profile_completed:!0};m&&(s.attorney_id=m.id,s.attorney_name=p(m));let{error:n}=await f.from("profiles").update(s).eq("id",r.id);if(n){alert("Error al guardar. Por favor, intente de nuevo."),t(!1);return}let{data:i}=await f.from("certificates").select("id").eq("user_id",r.id).order("issued_at",{ascending:!1}).limit(1);i&&i.length>0?window.location.href=`/certificado/${i[0].id}`:window.location.href="/panel"},j=c.length>1,N=1===c.length,_=m&&g===a.attorney_email;return(0,r.jsx)("main",{className:"min-h-screen bg-gray-50 py-12 px-4 md:px-6",children:(0,r.jsxs)("div",{className:"max-w-2xl mx-auto",children:[(0,r.jsxs)("div",{className:"text-center mb-8",children:[(0,r.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Informaci\xf3n del Certificado"}),(0,r.jsx)("p",{className:"text-gray-600",children:"Ingrese su nombre exactamente como aparece en sus documentos legales. Esta informaci\xf3n aparecer\xe1 en su certificado oficial."}),(0,r.jsx)("p",{className:"text-sm text-blue-700 bg-blue-50 rounded-lg px-4 py-3 mt-4 inline-block",children:"Todos los certificados se emiten en ingl\xe9s para su aceptaci\xf3n por los tribunales de Estados Unidos."})]}),(0,r.jsx)("div",{className:"bg-white rounded-2xl shadow-xl p-3 md:p-8 border border-gray-200",children:(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-semibold text-gray-900 mb-2",style:{fontSize:"22px"},children:"Nombre Legal Completo *"}),(0,r.jsx)("input",{type:"text",value:a.legal_name,onChange:e=>i({...a,legal_name:e.target.value}),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-gray-900",placeholder:"Este nombre aparecer\xe1 en su certificado",style:{fontSize:"14px"},required:!0}),(0,r.jsx)("p",{style:{fontSize:"7px"},className:"text-gray-500 mt-1",children:"Este nombre debe coincidir con sus documentos legales y expedientes judiciales"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block font-semibold text-gray-900 mb-2",style:{fontSize:"14px"},children:"Estado Donde se Present\xf3 el Caso"}),(0,r.jsxs)("select",{value:a.court_state,onChange:e=>i({...a,court_state:e.target.value}),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-gray-900 bg-white",style:{fontSize:"16px"},children:[(0,r.jsx)("option",{value:"",children:"Seleccionar Estado (Opcional)"}),n.map(e=>(0,r.jsx)("option",{value:e,children:e},e))]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block font-semibold text-gray-900 mb-2",style:{fontSize:"14px"},children:"Condado / Parroquia / Distrito / Ciudad"}),(0,r.jsx)("input",{type:"text",value:a.court_county,onChange:e=>i({...a,court_county:e.target.value}),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-gray-900",placeholder:"Opcional",style:{fontSize:"16px"}})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block font-semibold text-gray-900 mb-2",style:{fontSize:"14px"},children:"N\xfamero de Caso / Expediente / Causa"}),(0,r.jsx)("input",{type:"text",value:a.case_number,onChange:e=>i({...a,case_number:e.target.value}),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-gray-900",placeholder:"Opcional",style:{fontSize:"16px"}})]}),(0,r.jsxs)("div",{className:"border-t border-gray-200 pt-6",children:[(0,r.jsx)("h3",{className:"font-semibold text-gray-900 mb-4",style:{fontSize:"14px"},children:"Informaci\xf3n del Abogado (Opcional)"}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",style:{fontSize:"11px"},children:"Nombre del Abogado"}),(0,r.jsx)("input",{type:"text",value:a.attorney_name,onChange:e=>i({...a,attorney_name:e.target.value}),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-gray-900",placeholder:"Nombre completo del abogado",style:{fontSize:"14px"}})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",style:{fontSize:"11px"},children:"Correo Electr\xf3nico del Abogado"}),(0,r.jsx)("input",{type:"email",value:a.attorney_email,onChange:e=>i({...a,attorney_email:e.target.value}),className:`w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-gray-900 ${_?"border-green-400 bg-green-50":j?"border-blue-400 bg-blue-50":g&&g!==a.attorney_email?"border-amber-400 bg-amber-50":"border-gray-300"}`,placeholder:"abogado@ejemplo.com",style:{fontSize:"14px"}}),(0,r.jsx)("p",{className:"text-gray-500 mt-1",style:{fontSize:"11px"},children:"Le enviaremos una copia de su certificado"})]}),x&&(0,r.jsxs)("div",{className:"flex items-center gap-2 text-sm text-gray-500",children:[(0,r.jsx)("div",{className:"w-4 h-4 border-2 border-gray-300 border-t-blue-500 rounded-full animate-spin"}),"Buscando abogado..."]}),j&&!x&&(0,r.jsxs)("div",{className:"rounded-lg p-4 bg-blue-50 border border-blue-200",children:[(0,r.jsx)("p",{className:"font-semibold text-blue-800 mb-3",children:"Se encontraron varios abogados con este correo electr\xf3nico:"}),(0,r.jsx)("div",{className:"space-y-2",children:c.map(e=>(0,r.jsx)("button",{type:"button",onClick:()=>{u(e)},className:`w-full text-left p-3 rounded-lg border-2 transition-colors ${m?.id===e.id?"border-green-500 bg-green-50":"border-gray-200 bg-white hover:border-blue-300"}`,children:(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)("div",{className:`w-5 h-5 rounded-full border-2 flex items-center justify-center ${m?.id===e.id?"border-green-500 bg-green-500":"border-gray-300"}`,children:m?.id===e.id&&(0,r.jsx)("svg",{className:"w-3 h-3 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:(0,r.jsx)("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"font-medium text-gray-900",children:p(e)}),e.firm_name&&(0,r.jsx)("p",{className:"text-sm text-gray-600",children:e.firm_name})]})]})},e.id))}),m&&(0,r.jsxs)("p",{className:"mt-3 text-sm text-green-700 flex items-center gap-2",children:[(0,r.jsx)("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20",children:(0,r.jsx)("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),"Seleccionado: ",p(m)]})]}),N&&!x&&(0,r.jsx)("div",{className:`rounded-lg p-4 ${_?"bg-green-50 border border-green-200":"bg-amber-50 border border-amber-200"}`,children:_?(0,r.jsxs)("div",{className:"flex items-start gap-3",children:[(0,r.jsx)("div",{className:"w-5 h-5 bg-green-500 rounded-full flex items-center justify-center flex-shrink-0 mt-0.5",children:(0,r.jsx)("svg",{className:"w-3 h-3 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:(0,r.jsx)("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"font-semibold text-green-800",children:"âœ“ Abogado Verificado"}),(0,r.jsxs)("p",{className:"text-sm text-green-700",children:[p(m),m.firm_name&&m.first_name&&(0,r.jsxs)("span",{className:"text-green-600",children:[" - ",m.firm_name]})]}),(0,r.jsx)("p",{className:"text-sm text-green-600 mt-1",children:g})]})]}):(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"font-semibold text-amber-800 mb-2",children:"\xbfEs este su abogado?"}),(0,r.jsxs)("p",{className:"text-sm text-amber-700 mb-3",children:["Encontramos a ",(0,r.jsx)("strong",{children:p(c[0])}),c[0].firm_name&&c[0].first_name&&(0,r.jsxs)("span",{children:[" de ",c[0].firm_name]}),g&&(0,r.jsxs)("span",{children:[" con el correo ",(0,r.jsx)("strong",{children:g})]})]}),g&&g!==a.attorney_email&&(0,r.jsx)("button",{type:"button",onClick:()=>{g&&i({...a,attorney_email:g})},className:"bg-amber-600 text-white px-4 py-2 rounded-lg text-sm font-semibold hover:bg-amber-700 transition-colors",children:"Usar este correo verificado"})]})})]})]}),(0,r.jsx)("button",{onClick:y,disabled:e||!a.legal_name||j&&!m,className:"w-full bg-blue-600 text-white py-4 rounded-lg font-bold hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed text-lg",children:e?"Guardando...":j&&!m?"Seleccione su abogado":"Guardar y Continuar"})]})})]})})}}},e=>{e.O(0,[5666,9338,8441,3794,7358],()=>e(e.s=6242)),_N_E=e.O()}]);