(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[566],{1142:(e,s,i)=>{"use strict";i.d(s,{U:()=>a});var t=i(9338);function a(){return(0,t.createBrowserClient)("https://qclacxcgfprkswuiboop.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InFjbGFjeGNnZnBya3N3dWlib29wIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjMxMTAwMDYsImV4cCI6MjA3ODY4NjAwNn0.FciBBWAgCDLB_BFEypmH5jbjsjPUkH3ij00u7PbG9gg")}},3321:(e,s,i)=>{"use strict";var t=i(4645);i.o(t,"useParams")&&i.d(s,{useParams:function(){return t.useParams}}),i.o(t,"useSearchParams")&&i.d(s,{useSearchParams:function(){return t.useSearchParams}})},5726:(e,s,i)=>{"use strict";i.d(s,{Ar:()=>o,By:()=>n,MB:()=>t,OO:()=>l,Qf:()=>a,tz:()=>r});let t=20,a=.7,r=15,n=[{id:1,slug:"leccion-1",titleEs:"Entendiendo lo que Est\xe1 Pasando",descriptionEs:"Entendiendo el duelo, la p\xe9rdida, y c\xf3mo los ni\xf1os experimentan el divorcio a diferentes edades.",estimatedTime:"~24 min",sections:[{id:"section_1_A",titleEs:"El Divorcio como P\xe9rdida"},{id:"section_1_B",titleEs:"C\xf3mo los Ni\xf1os Experimentan el Divorcio"}]},{id:2,slug:"leccion-2",titleEs:"Comunic\xe1ndose con Sus Hijos",descriptionEs:"C\xf3mo decirle a sus hijos sobre el divorcio y mantener comunicaci\xf3n abierta.",estimatedTime:"~20 min",sections:[{id:"section_2",titleEs:"Comunic\xe1ndose con Sus Hijos"}]},{id:3,slug:"leccion-3",titleEs:"Preguntas Comunes de los Ni\xf1os",descriptionEs:"Respondiendo las preguntas dif\xedciles que los ni\xf1os hacen sobre el divorcio.",estimatedTime:"~15 min",sections:[{id:"section_3",titleEs:"Preguntas Comunes de los Ni\xf1os"}]},{id:4,slug:"leccion-4",titleEs:"Apoyando el Bienestar Emocional",descriptionEs:"Validando sentimientos, reconociendo se\xf1ales de advertencia, y desarrollando habilidades de afrontamiento.",estimatedTime:"~25 min",sections:[{id:"section_4_A",titleEs:"Validaci\xf3n y Apoyo"},{id:"section_4_B",titleEs:"Se\xf1ales de Advertencia"},{id:"section_4_C",titleEs:"Desarrollando Habilidades de Afrontamiento"}]},{id:5,slug:"leccion-5",titleEs:"Manejando Sus Propias Emociones",descriptionEs:"Cuid\xe1ndose a s\xed mismo/a para poder cuidar a sus hijos.",estimatedTime:"~18 min",sections:[{id:"section_5",titleEs:"Manejando Sus Propias Emociones"}]},{id:6,slug:"leccion-6",titleEs:"Trabajando con el Otro Padre",descriptionEs:"Estrategias de coparentalidad, crianza paralela, y comunicaci\xf3n BIFF.",estimatedTime:"~20 min",sections:[{id:"section_6_A",titleEs:"Enfoques de Coparentalidad"},{id:"section_6_B",titleEs:"Estrategias de Comunicaci\xf3n"},{id:"section_6_C",titleEs:"Los Tres Grandes Errores"}]},{id:7,slug:"leccion-7",titleEs:"Seguridad y Apoyo",descriptionEs:"Reconociendo el abuso, planificaci\xf3n de seguridad, y cu\xe1ndo es necesaria la crianza paralela.",estimatedTime:"~16 min",sections:[{id:"section_7_A",titleEs:"Reconociendo el Abuso"},{id:"section_7_B",titleEs:"Planificaci\xf3n de Seguridad"}]},{id:8,slug:"leccion-8",titleEs:"Realidades Financieras",descriptionEs:"Entendiendo la manutenci\xf3n, manejando gastos, y protegiendo a los ni\xf1os del estr\xe9s financiero.",estimatedTime:"~14 min",sections:[{id:"section_8",titleEs:"Realidades Financieras"}]},{id:9,slug:"leccion-9",titleEs:"Haciendo que el Tiempo de Crianza Funcione",descriptionEs:"Horarios, rutinas, y haciendo que dos hogares se sientan como hogar.",estimatedTime:"~15 min",sections:[{id:"section_9_A",titleEs:"Horarios de Crianza"},{id:"section_9_B",titleEs:"Dos Hogares"}]},{id:10,slug:"leccion-10",titleEs:"Ayudando a los Ni\xf1os a Trav\xe9s de las Transiciones",descriptionEs:"Haciendo los intercambios m\xe1s f\xe1ciles y ayudando a los ni\xf1os a ajustarse a moverse entre hogares.",estimatedTime:"~16 min",sections:[{id:"section_10",titleEs:"Ayudando a los Ni\xf1os a Trav\xe9s de las Transiciones"}]},{id:11,slug:"leccion-11",titleEs:"D\xedas Festivos, Hitos y Ocasiones Especiales",descriptionEs:"Navegando d\xedas festivos, cumplea\xf1os, y eventos especiales entre dos hogares.",estimatedTime:"~23 min",sections:[{id:"section_11_A",titleEs:"D\xedas Festivos"},{id:"section_11_B",titleEs:"Cumplea\xf1os e Hitos"}]},{id:12,slug:"leccion-12",titleEs:"El Primer A\xf1o y las Primeras Veces",descriptionEs:"Navegando el primer a\xf1o despu\xe9s del divorcio y manejando momentos importantes.",estimatedTime:"~13 min",sections:[{id:"section_12",titleEs:"El Primer A\xf1o y las Primeras Veces"}]},{id:13,slug:"leccion-13",titleEs:"Cuando un Padre Se Desconecta",descriptionEs:"Apoyando a su hijo cuando el otro padre est\xe1 ausente o no involucrado.",estimatedTime:"~22 min",sections:[{id:"section_13",titleEs:"Cuando un Padre Se Desconecta"}]},{id:14,slug:"leccion-14",titleEs:"Recursos Adicionales",descriptionEs:"Apoyo de crisis, encontrando terapeutas, herramientas de coparentalidad, y recursos espec\xedficos de Florida.",estimatedTime:"~10 min",sections:[{id:"section_14",titleEs:"Recursos Adicionales"}]},{id:15,slug:"leccion-15",titleEs:"Cierre: Avanzando",descriptionEs:"Reflexionando sobre su camino y planificando para el futuro.",estimatedTime:"~5 min",sections:[{id:"section_15",titleEs:"Avanzando"}]}],o={coparenting:{en:"Co-Parenting Class",es:"Clase de Coparentalidad"},parenting:{en:"Parenting Class",es:"Clase de Crianza"}},l=[]},6823:(e,s,i)=>{"use strict";i.r(s),i.d(s,{default:()=>m});var t=i(5155),a=i(2115),r=i(1142),n=i(5726),o=i(8500),l=i.n(o),d=i(3321);let c=Math.ceil(n.MB*n.Qf);function u(e){let s=[...e];for(let e=s.length-1;e>0;e--){let i=Math.floor(Math.random()*(e+1));[s[e],s[i]]=[s[i],s[e]]}return s}function m(){let e=(0,d.useParams)().courseType,s=`exam_v3_${e}`,[i,o]=(0,a.useState)(!0),[m,g]=(0,a.useState)("intro"),[b,h]=(0,a.useState)(!1),[p,x]=(0,a.useState)([]),[f,y]=(0,a.useState)(0),[j,_]=(0,a.useState)(0),[E,w]=(0,a.useState)(null),[N,v]=(0,a.useState)(!1),[C,S]=(0,a.useState)(!1),[A,B]=(0,a.useState)(""),P=(0,r.U)();(0,a.useEffect)(()=>{if("exam"===m&&p.length>0)try{localStorage.setItem(s,JSON.stringify({questions:p,currentIndex:f,correctCount:j,selectedAnswer:E,submitted:N,isCorrect:C,wrongRed:A}))}catch{}},[m,p,f,j,E,N,C,A,s]),(0,a.useEffect)(()=>{(async()=>{let{data:{user:i}}=await P.auth.getUser();if(!i){window.location.href="/iniciar-sesion";return}let{data:t}=await P.from("certificates").select("id").eq("user_id",i.id).eq("course_type",e).limit(1);if(t&&t.length>0){window.location.href=`/certificado/${t[0].id}`;return}let{data:a}=await P.from("course_progress").select("lessons_completed").eq("user_id",i.id).eq("course_type",e).single();if(!a||a.lessons_completed.length<15){window.location.href=`/curso/${e}`;return}try{let e=localStorage.getItem(s);if(e){let s=JSON.parse(e);s.questions?.length&&h(!0)}}catch{}o(!1)})()},[e,s]);let M=(0,a.useCallback)(()=>{localStorage.removeItem(s)},[s]),T=async()=>{M(),h(!1);let{data:{user:e}}=await P.auth.getUser();if(!e)return;let s=["A","B","C"],i=s[Math.floor(Math.random()*s.length)],{data:t}=await P.from("exam_questions").select("*").eq("version",i);t?.length?(x(u(t).slice(0,n.MB).map(e=>{let s=[{label:"A",text:e.answer_a,originalLabel:"A"},{label:"B",text:e.answer_b,originalLabel:"B"},{label:"C",text:e.answer_c,originalLabel:"C"},{label:"D",text:e.answer_d,originalLabel:"D"}];return{...e,shuffledAnswers:u(s).map((e,s)=>({...e,label:["A","B","C","D"][s]}))}})),y(0),_(0),w(null),v(!1),S(!1),B(""),g("exam")):alert("Error")},I=async()=>{M();let{data:{user:s}}=await P.auth.getUser();if(!s)return;let i=j>=c,t=Math.round(j/n.MB*100);if(await P.from("exam_attempts").insert({user_id:s.id,course_type:e,questions_shown:p.map(e=>e.id),score:t,passed:i}),i){let{data:i}=await P.from("certificates").select("id").eq("user_id",s.id).eq("course_type",e).limit(1);if(!i||0===i.length){let i=`PKF-${Math.random().toString(36).substring(2,8).toUpperCase()}`,t=Math.random().toString(36).substring(2,10).toUpperCase(),{data:a}=await P.from("certificates").insert({user_id:s.id,course_type:e,certificate_number:i,verification_code:t}).select("id").single();a?.id&&fetch("/api/send-attorney-email",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({certificateId:a.id})}).catch(console.error),await P.from("course_progress").update({completed_at:new Date().toISOString()}).eq("user_id",s.id).eq("course_type",e)}}g("done")};if(i)return(0,t.jsx)("main",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,t.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})});if("done"===m){let s=j>=c,i=Math.round(j/n.MB*100);return(0,t.jsx)("main",{className:"min-h-screen bg-gray-50 flex items-center justify-center p-6",children:(0,t.jsx)("div",{className:"bg-white rounded-2xl shadow-lg p-8 max-w-md w-full text-center",children:s?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"w-20 h-20 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-6",children:(0,t.jsx)("svg",{className:"w-10 h-10 text-green-600",fill:"currentColor",viewBox:"0 0 20 20",children:(0,t.jsx)("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})}),(0,t.jsx)("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"\xa1Felicitaciones!"}),(0,t.jsxs)("p",{className:"text-gray-600 mb-6",children:["Ha aprobado con ",i,"% (",j,"/",n.MB,")"]}),(0,t.jsx)(l(),{href:"/completar-perfil",className:"block w-full bg-blue-600 text-white py-4 rounded-lg font-bold hover:bg-blue-700 transition-colors mb-3",children:"Descargar Certificado"}),(0,t.jsx)(l(),{href:"/panel",className:"block w-full bg-gray-100 text-gray-700 py-3 rounded-lg hover:bg-gray-200 transition-colors",children:"Volver a los Cursos"})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"w-20 h-20 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-6",children:(0,t.jsx)("svg",{className:"w-10 h-10 text-red-600",fill:"currentColor",viewBox:"0 0 20 20",children:(0,t.jsx)("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})}),(0,t.jsx)("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"No Aprob\xf3"}),(0,t.jsxs)("p",{className:"text-gray-600 mb-6",children:["Obtuvo ",i,"% — necesita 70%"]}),(0,t.jsx)("button",{onClick:()=>{M(),x([]),y(0),_(0),w(null),v(!1),S(!1),B(""),g("intro")},className:"block w-full bg-blue-600 text-white py-3 rounded-lg font-bold hover:bg-blue-700 mb-3",children:"Reintentar"}),(0,t.jsx)(l(),{href:`/curso/${e}`,className:"block w-full bg-gray-100 text-gray-700 py-3 rounded-lg hover:bg-gray-200",children:"Revisar el Curso"})]})})})}if("intro"===m)return(0,t.jsxs)("main",{className:"min-h-screen bg-gray-50",children:[(0,t.jsx)("header",{className:"bg-white border-b",children:(0,t.jsx)("div",{className:"max-w-4xl mx-auto px-6 py-4",children:(0,t.jsx)(l(),{href:`/curso/${e}`,className:"text-blue-600 text-sm",children:"← Volver al Curso"})})}),(0,t.jsx)("div",{className:"max-w-2xl mx-auto px-6 py-12",children:(0,t.jsxs)("div",{className:"bg-white rounded-2xl shadow-lg p-8",children:[(0,t.jsx)("h1",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Examen Final"}),b&&(0,t.jsxs)("div",{className:"bg-amber-50 border border-amber-200 rounded-lg p-4 mb-6",children:[(0,t.jsx)("p",{className:"font-semibold text-amber-800 mb-2",children:"Examen en progreso"}),(0,t.jsxs)("div",{className:"flex gap-3",children:[(0,t.jsx)("button",{onClick:()=>{try{let e=localStorage.getItem(s);if(e){let s=JSON.parse(e);x(s.questions||[]),y(s.currentIndex||0),_(s.correctCount||0),w(null),v(!1),S(!1),B(""),g("exam"),h(!1)}}catch{M()}},className:"bg-amber-600 text-white px-4 py-2 rounded-lg hover:bg-amber-700",children:"Continuar"}),(0,t.jsx)("button",{onClick:T,className:"bg-gray-200 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-300",children:"Empezar de Nuevo"})]})]}),(0,t.jsxs)("ul",{className:"space-y-2 text-gray-600 mb-8",children:[(0,t.jsxs)("li",{children:["• ",n.MB," preguntas"]}),(0,t.jsxs)("li",{children:["• Necesita 70% (",c," correctas)"]}),(0,t.jsx)("li",{children:"• Progreso guardado autom\xe1ticamente"})]}),!b&&(0,t.jsx)("button",{onClick:T,className:"w-full bg-blue-600 text-white py-4 rounded-lg font-bold hover:bg-blue-700 text-lg",children:"Comenzar Examen"})]})})]});let q=p[f];return q?(0,t.jsxs)("main",{className:"min-h-screen bg-gray-50",children:[(0,t.jsx)("div",{className:"bg-white border-b",children:(0,t.jsxs)("div",{className:"max-w-4xl mx-auto px-6 py-4",children:[(0,t.jsxs)("div",{className:"flex justify-between text-sm text-gray-600 mb-2",children:[(0,t.jsxs)("span",{children:["Pregunta ",f+1," de ",n.MB]}),(0,t.jsxs)("span",{children:[j," correctas"]})]}),(0,t.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,t.jsx)("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:`${(f+1)/n.MB*100}%`}})})]})}),(0,t.jsx)("div",{className:"max-w-2xl mx-auto px-6 py-8",children:(0,t.jsxs)("div",{className:"bg-white rounded-2xl shadow-lg p-8",children:[(0,t.jsx)("h2",{className:"text-lg font-semibold text-gray-900 mb-6",children:q.question_text}),(0,t.jsx)("div",{className:"space-y-3 mb-6",children:q.shuffledAnswers.map(e=>{let s=E===e.label,i=N&&s&&!C;return(0,t.jsxs)("button",{onClick:()=>!N&&w(e.label),disabled:N,className:`w-full p-4 rounded-lg border-2 text-left text-gray-900 transition-colors ${i?"border-red-500 bg-red-50":s?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"} ${N?"cursor-default":"cursor-pointer"}`,children:[(0,t.jsxs)("span",{className:"font-semibold mr-2",children:[e.label,"."]}),e.text]},`q${f}-${e.label}`)})}),N&&!C&&(0,t.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-6",children:[(0,t.jsx)("p",{className:"font-semibold text-red-800 mb-2",children:"Incorrecto"}),(0,t.jsxs)("p",{className:"text-red-600 text-sm",children:[(0,t.jsx)("strong",{children:"Revise:"})," ",A?A?A.replace(/(\d+)[A-Za-z]+/g,"$1"):"":"el material del curso"]})]}),N&&C&&(0,t.jsx)("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4 mb-6",children:(0,t.jsx)("p",{className:"font-semibold text-green-800",children:"\xa1Correcto!"})}),N?(0,t.jsx)("button",{onClick:()=>{f<p.length-1?(y(e=>e+1),w(null),v(!1),S(!1),B("")):I()},className:"w-full bg-blue-600 text-white py-3 rounded-lg font-bold hover:bg-blue-700 transition-colors",children:f<p.length-1?"Siguiente Pregunta":"Ver Resultados"}):(0,t.jsx)("button",{onClick:()=>{if(!E||N)return;let e=p[f],s=e.shuffledAnswers.find(e=>e.label===E),i=s?.originalLabel?.toUpperCase()===e.correct_position?.toUpperCase(),t="";if(!i&&s){let i=s.originalLabel;"A"===i&&(t=e.wrong_a_redirect||""),"B"===i&&(t=e.wrong_b_redirect||""),"C"===i&&(t=e.wrong_c_redirect||""),"D"===i&&(t=e.wrong_d_redirect||"")}S(i),B(t),v(!0),i&&_(e=>e+1)},disabled:!E,className:"w-full bg-blue-600 text-white py-3 rounded-lg font-bold hover:bg-blue-700 disabled:opacity-50 transition-colors",children:"Confirmar"})]},f)})]}):null}},9725:(e,s,i)=>{Promise.resolve().then(i.bind(i,6823))}},e=>{e.O(0,[8500,5666,9338,8441,3794,7358],()=>e(e.s=9725)),_N_E=e.O()}]);